{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Using TensorFlow backend.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "#import matplotlib # Solve \"RuntimeError\" on mac OSX\n",
    "#matplotlib.use('TkAgg') # Solve \"RuntimeError\" on mac OSX\n",
    "import matplotlib.pyplot as plt\n",
    "import os\n",
    "from keras.models import Sequential\n",
    "from keras.layers import Conv2D, MaxPooling2D\n",
    "from keras.layers.core import Dense, Dropout, Activation, Flatten\n",
    "from keras.utils import to_categorical\n",
    "import pickle\n",
    "import time\n",
    "from keras.callbacks import TensorBoard\n",
    "\n",
    "'''Load variables'''\n",
    "\n",
    "pickle_in = open(\"pretrained/X_train.pickle\",\"rb\")\n",
    "X_train = pickle.load(pickle_in)\n",
    "\n",
    "pickle_in = open(\"pretrained/y_train.pickle\",\"rb\")\n",
    "y_train = pickle.load(pickle_in)\n",
    "\n",
    "pickle_in = open(\"pretrained/X_test.pickle\",\"rb\")\n",
    "X_test = pickle.load(pickle_in)\n",
    "\n",
    "pickle_in = open(\"pretrained/y_test.pickle\",\"rb\")\n",
    "y_test = pickle.load(pickle_in)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1-conv-32-nodes-0-dense-1544499511\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 1s 243us/step - loss: 0.8178 - acc: 0.6435 - val_loss: 0.6031 - val_acc: 0.7495\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 201us/step - loss: 0.5194 - acc: 0.8019 - val_loss: 0.5076 - val_acc: 0.8032\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 206us/step - loss: 0.4320 - acc: 0.8354 - val_loss: 0.4642 - val_acc: 0.8297\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 210us/step - loss: 0.3653 - acc: 0.8731 - val_loss: 0.4270 - val_acc: 0.8416\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 210us/step - loss: 0.3323 - acc: 0.8836 - val_loss: 0.3950 - val_acc: 0.8444\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 213us/step - loss: 0.2799 - acc: 0.9072 - val_loss: 0.3841 - val_acc: 0.8507\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 215us/step - loss: 0.2584 - acc: 0.9144 - val_loss: 0.3635 - val_acc: 0.8667\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 218us/step - loss: 0.2217 - acc: 0.9285 - val_loss: 0.3607 - val_acc: 0.8604\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 214us/step - loss: 0.2029 - acc: 0.9359 - val_loss: 0.3840 - val_acc: 0.8521\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 211us/step - loss: 0.1862 - acc: 0.9446 - val_loss: 0.3635 - val_acc: 0.8688\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 213us/step - loss: 0.1632 - acc: 0.9572 - val_loss: 0.3594 - val_acc: 0.8660\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 210us/step - loss: 0.1469 - acc: 0.9611 - val_loss: 0.3457 - val_acc: 0.8758\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 211us/step - loss: 0.1412 - acc: 0.9635 - val_loss: 0.3451 - val_acc: 0.8772\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 212us/step - loss: 0.1181 - acc: 0.9731 - val_loss: 0.4106 - val_acc: 0.8458\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 219us/step - loss: 0.1158 - acc: 0.9731 - val_loss: 0.3775 - val_acc: 0.8751\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 220us/step - loss: 0.1013 - acc: 0.9802 - val_loss: 0.3553 - val_acc: 0.8709\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 235us/step - loss: 0.0903 - acc: 0.9835 - val_loss: 0.3655 - val_acc: 0.8723\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 235us/step - loss: 0.0823 - acc: 0.9832 - val_loss: 0.3570 - val_acc: 0.8758\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 237us/step - loss: 0.0729 - acc: 0.9859 - val_loss: 0.3979 - val_acc: 0.8639\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 237us/step - loss: 0.0633 - acc: 0.9922 - val_loss: 0.3725 - val_acc: 0.8758\n",
      "2-conv-32-nodes-0-dense-1544499526\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 1s 297us/step - loss: 0.8206 - acc: 0.6199 - val_loss: 0.5833 - val_acc: 0.7697\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 265us/step - loss: 0.5484 - acc: 0.7914 - val_loss: 0.4943 - val_acc: 0.8151\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 267us/step - loss: 0.4251 - acc: 0.8462 - val_loss: 0.4179 - val_acc: 0.8535\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 269us/step - loss: 0.3718 - acc: 0.8641 - val_loss: 0.4044 - val_acc: 0.8528\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 266us/step - loss: 0.3214 - acc: 0.8869 - val_loss: 0.4253 - val_acc: 0.8339\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 270us/step - loss: 0.2985 - acc: 0.8961 - val_loss: 0.3776 - val_acc: 0.8590\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 269us/step - loss: 0.2765 - acc: 0.8988 - val_loss: 0.4249 - val_acc: 0.8290\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 268us/step - loss: 0.2610 - acc: 0.9027 - val_loss: 0.3422 - val_acc: 0.8793\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 271us/step - loss: 0.2315 - acc: 0.9177 - val_loss: 0.3713 - val_acc: 0.8639\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 267us/step - loss: 0.2290 - acc: 0.9135 - val_loss: 0.3303 - val_acc: 0.8765\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 267us/step - loss: 0.2102 - acc: 0.9207 - val_loss: 0.3729 - val_acc: 0.8702\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 270us/step - loss: 0.1938 - acc: 0.9279 - val_loss: 0.3652 - val_acc: 0.8667\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 265us/step - loss: 0.1764 - acc: 0.9315 - val_loss: 0.3412 - val_acc: 0.8779\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 249us/step - loss: 0.1652 - acc: 0.9398 - val_loss: 0.3332 - val_acc: 0.8828\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 256us/step - loss: 0.1527 - acc: 0.9407 - val_loss: 0.3403 - val_acc: 0.8835\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 256us/step - loss: 0.1434 - acc: 0.9500 - val_loss: 0.3444 - val_acc: 0.8758\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 255us/step - loss: 0.1432 - acc: 0.9461 - val_loss: 0.3979 - val_acc: 0.8611\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 258us/step - loss: 0.1301 - acc: 0.9497 - val_loss: 0.3860 - val_acc: 0.8639\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 266us/step - loss: 0.1180 - acc: 0.9575 - val_loss: 0.4111 - val_acc: 0.8625\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 265us/step - loss: 0.1064 - acc: 0.9659 - val_loss: 0.3695 - val_acc: 0.8842\n",
      "3-conv-32-nodes-0-dense-1544499545\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 1s 347us/step - loss: 0.8891 - acc: 0.5744 - val_loss: 0.6902 - val_acc: 0.7146\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 283us/step - loss: 0.6168 - acc: 0.7468 - val_loss: 0.5534 - val_acc: 0.7795\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 308us/step - loss: 0.5318 - acc: 0.7884 - val_loss: 0.5854 - val_acc: 0.7565\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 310us/step - loss: 0.4909 - acc: 0.8105 - val_loss: 0.4844 - val_acc: 0.8081\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 317us/step - loss: 0.4442 - acc: 0.8312 - val_loss: 0.4574 - val_acc: 0.8214\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 304us/step - loss: 0.4200 - acc: 0.8462 - val_loss: 0.4574 - val_acc: 0.8144\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 303us/step - loss: 0.3880 - acc: 0.8578 - val_loss: 0.4133 - val_acc: 0.8423\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 308us/step - loss: 0.3521 - acc: 0.8668 - val_loss: 0.4057 - val_acc: 0.8304\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 303us/step - loss: 0.3466 - acc: 0.8725 - val_loss: 0.4126 - val_acc: 0.8325\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 307us/step - loss: 0.3476 - acc: 0.8689 - val_loss: 0.4003 - val_acc: 0.8416\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 306us/step - loss: 0.3130 - acc: 0.8818 - val_loss: 0.3678 - val_acc: 0.8709\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 312us/step - loss: 0.2917 - acc: 0.8884 - val_loss: 0.3775 - val_acc: 0.8716\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 314us/step - loss: 0.2916 - acc: 0.8964 - val_loss: 0.3916 - val_acc: 0.8569\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 314us/step - loss: 0.2722 - acc: 0.8982 - val_loss: 0.4246 - val_acc: 0.8297\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 300us/step - loss: 0.2716 - acc: 0.9015 - val_loss: 0.3555 - val_acc: 0.8723\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 297us/step - loss: 0.2432 - acc: 0.9150 - val_loss: 0.3367 - val_acc: 0.8800\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 306us/step - loss: 0.2313 - acc: 0.9132 - val_loss: 0.3396 - val_acc: 0.8779\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 295us/step - loss: 0.2260 - acc: 0.9141 - val_loss: 0.3265 - val_acc: 0.8870\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 292us/step - loss: 0.2064 - acc: 0.9228 - val_loss: 0.3664 - val_acc: 0.8590\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 300us/step - loss: 0.1961 - acc: 0.9294 - val_loss: 0.3542 - val_acc: 0.8772\n",
      "1-conv-64-nodes-0-dense-1544499567\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 1s 280us/step - loss: 0.7211 - acc: 0.7007 - val_loss: 0.5152 - val_acc: 0.7969\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 237us/step - loss: 0.4408 - acc: 0.8318 - val_loss: 0.5359 - val_acc: 0.7969\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 239us/step - loss: 0.3492 - acc: 0.8806 - val_loss: 0.4043 - val_acc: 0.8528\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 242us/step - loss: 0.2871 - acc: 0.8985 - val_loss: 0.3801 - val_acc: 0.8611\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 244us/step - loss: 0.2468 - acc: 0.9153 - val_loss: 0.3855 - val_acc: 0.8479\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 238us/step - loss: 0.2156 - acc: 0.9288 - val_loss: 0.3706 - val_acc: 0.8681\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 235us/step - loss: 0.1799 - acc: 0.9422 - val_loss: 0.3528 - val_acc: 0.8807\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 241us/step - loss: 0.1553 - acc: 0.9569 - val_loss: 0.3630 - val_acc: 0.8695\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 245us/step - loss: 0.1307 - acc: 0.9653 - val_loss: 0.3652 - val_acc: 0.8660\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 241us/step - loss: 0.1126 - acc: 0.9722 - val_loss: 0.3793 - val_acc: 0.8576\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 238us/step - loss: 0.1037 - acc: 0.9758 - val_loss: 0.3757 - val_acc: 0.8625\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 239us/step - loss: 0.0878 - acc: 0.9811 - val_loss: 0.3785 - val_acc: 0.8681\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 226us/step - loss: 0.0758 - acc: 0.9874 - val_loss: 0.3698 - val_acc: 0.8751\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 233us/step - loss: 0.0699 - acc: 0.9880 - val_loss: 0.3906 - val_acc: 0.8653\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 243us/step - loss: 0.0640 - acc: 0.9904 - val_loss: 0.4029 - val_acc: 0.8604\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 234us/step - loss: 0.0495 - acc: 0.9952 - val_loss: 0.4060 - val_acc: 0.8716\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 228us/step - loss: 0.0451 - acc: 0.9946 - val_loss: 0.4184 - val_acc: 0.8583\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 239us/step - loss: 0.0369 - acc: 0.9967 - val_loss: 0.4121 - val_acc: 0.8702\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 235us/step - loss: 0.0315 - acc: 0.9994 - val_loss: 0.4203 - val_acc: 0.8730\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 236us/step - loss: 0.0320 - acc: 0.9982 - val_loss: 0.4348 - val_acc: 0.8660\n",
      "2-conv-64-nodes-0-dense-1544499584\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 1s 311us/step - loss: 0.8051 - acc: 0.6202 - val_loss: 0.5713 - val_acc: 0.7788\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 264us/step - loss: 0.4711 - acc: 0.8162 - val_loss: 0.4309 - val_acc: 0.8423\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 280us/step - loss: 0.3522 - acc: 0.8659 - val_loss: 0.4056 - val_acc: 0.8437\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 281us/step - loss: 0.3117 - acc: 0.8943 - val_loss: 0.3692 - val_acc: 0.8542\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 281us/step - loss: 0.2722 - acc: 0.9015 - val_loss: 0.3419 - val_acc: 0.8737\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 282us/step - loss: 0.2363 - acc: 0.9204 - val_loss: 0.4049 - val_acc: 0.8444\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 275us/step - loss: 0.2118 - acc: 0.9225 - val_loss: 0.4081 - val_acc: 0.8597\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 266us/step - loss: 0.2050 - acc: 0.9225 - val_loss: 0.3583 - val_acc: 0.8709\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 271us/step - loss: 0.1781 - acc: 0.9377 - val_loss: 0.3485 - val_acc: 0.8716\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 283us/step - loss: 0.1509 - acc: 0.9473 - val_loss: 0.3385 - val_acc: 0.8744\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 274us/step - loss: 0.1193 - acc: 0.9599 - val_loss: 0.3757 - val_acc: 0.8660\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 288us/step - loss: 0.1082 - acc: 0.9623 - val_loss: 0.4159 - val_acc: 0.8569\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 274us/step - loss: 0.0852 - acc: 0.9752 - val_loss: 0.4421 - val_acc: 0.8569\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 287us/step - loss: 0.0761 - acc: 0.9761 - val_loss: 0.3996 - val_acc: 0.8772\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 288us/step - loss: 0.0652 - acc: 0.9796 - val_loss: 0.3943 - val_acc: 0.8772\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 283us/step - loss: 0.0528 - acc: 0.9874 - val_loss: 0.4161 - val_acc: 0.8730\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 282us/step - loss: 0.0459 - acc: 0.9898 - val_loss: 0.4223 - val_acc: 0.8807\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 276us/step - loss: 0.0423 - acc: 0.9892 - val_loss: 0.4246 - val_acc: 0.8744\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 276us/step - loss: 0.0274 - acc: 0.9943 - val_loss: 0.4363 - val_acc: 0.8814\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 270us/step - loss: 0.0194 - acc: 0.9994 - val_loss: 0.4391 - val_acc: 0.8911\n",
      "3-conv-64-nodes-0-dense-1544499604\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 1s 350us/step - loss: 0.8582 - acc: 0.5816 - val_loss: 0.6660 - val_acc: 0.7181\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 287us/step - loss: 0.6006 - acc: 0.7588 - val_loss: 0.5932 - val_acc: 0.7446\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 320us/step - loss: 0.4676 - acc: 0.8186 - val_loss: 0.4664 - val_acc: 0.8179\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 314us/step - loss: 0.4172 - acc: 0.8468 - val_loss: 0.4723 - val_acc: 0.8032\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 310us/step - loss: 0.3628 - acc: 0.8644 - val_loss: 0.4275 - val_acc: 0.8409\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 320us/step - loss: 0.3232 - acc: 0.8827 - val_loss: 0.3971 - val_acc: 0.8604\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 320us/step - loss: 0.2888 - acc: 0.8911 - val_loss: 0.3740 - val_acc: 0.8618\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 305us/step - loss: 0.2691 - acc: 0.8988 - val_loss: 0.4177 - val_acc: 0.8437\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 319us/step - loss: 0.2474 - acc: 0.9072 - val_loss: 0.3628 - val_acc: 0.8674\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 311us/step - loss: 0.2281 - acc: 0.9138 - val_loss: 0.3302 - val_acc: 0.8925\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 313us/step - loss: 0.1875 - acc: 0.9336 - val_loss: 0.3904 - val_acc: 0.8653\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 307us/step - loss: 0.1606 - acc: 0.9425 - val_loss: 0.3422 - val_acc: 0.8807\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 310us/step - loss: 0.1618 - acc: 0.9386 - val_loss: 0.3595 - val_acc: 0.8779\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 312us/step - loss: 0.1229 - acc: 0.9551 - val_loss: 0.3735 - val_acc: 0.8835\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 319us/step - loss: 0.1171 - acc: 0.9590 - val_loss: 0.3530 - val_acc: 0.8863\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 319us/step - loss: 0.0843 - acc: 0.9719 - val_loss: 0.3791 - val_acc: 0.8807\n",
      "Epoch 17/20\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "3341/3341 [==============================] - 1s 326us/step - loss: 0.0791 - acc: 0.9752 - val_loss: 0.3726 - val_acc: 0.8842\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 329us/step - loss: 0.0623 - acc: 0.9796 - val_loss: 0.3880 - val_acc: 0.8870\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 326us/step - loss: 0.0787 - acc: 0.9728 - val_loss: 0.3950 - val_acc: 0.8793\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 332us/step - loss: 0.0553 - acc: 0.9865 - val_loss: 0.4128 - val_acc: 0.8849\n",
      "1-conv-128-nodes-0-dense-1544499626\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 1s 295us/step - loss: 0.7039 - acc: 0.6983 - val_loss: 0.5788 - val_acc: 0.7962\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 243us/step - loss: 0.3984 - acc: 0.8539 - val_loss: 0.4385 - val_acc: 0.8304\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 260us/step - loss: 0.2967 - acc: 0.8955 - val_loss: 0.3785 - val_acc: 0.8667\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 255us/step - loss: 0.2496 - acc: 0.9207 - val_loss: 0.4150 - val_acc: 0.8332\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 260us/step - loss: 0.1909 - acc: 0.9383 - val_loss: 0.3934 - val_acc: 0.8548\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 262us/step - loss: 0.1555 - acc: 0.9524 - val_loss: 0.3746 - val_acc: 0.8660\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 256us/step - loss: 0.1241 - acc: 0.9662 - val_loss: 0.3886 - val_acc: 0.8702\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 253us/step - loss: 0.0973 - acc: 0.9770 - val_loss: 0.3677 - val_acc: 0.8730\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 258us/step - loss: 0.0769 - acc: 0.9877 - val_loss: 0.4228 - val_acc: 0.8507\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 262us/step - loss: 0.0667 - acc: 0.9880 - val_loss: 0.3842 - val_acc: 0.8786\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 264us/step - loss: 0.0583 - acc: 0.9922 - val_loss: 0.4288 - val_acc: 0.8548\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 267us/step - loss: 0.0442 - acc: 0.9943 - val_loss: 0.3951 - val_acc: 0.8779\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 264us/step - loss: 0.0345 - acc: 0.9979 - val_loss: 0.4106 - val_acc: 0.8730\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 268us/step - loss: 0.0301 - acc: 0.9979 - val_loss: 0.4134 - val_acc: 0.8772\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 264us/step - loss: 0.0242 - acc: 0.9985 - val_loss: 0.4288 - val_acc: 0.8688\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 255us/step - loss: 0.0201 - acc: 0.9991 - val_loss: 0.4577 - val_acc: 0.8632\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 259us/step - loss: 0.0169 - acc: 0.9991 - val_loss: 0.4710 - val_acc: 0.8632\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 262us/step - loss: 0.0164 - acc: 1.0000 - val_loss: 0.4447 - val_acc: 0.8793\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 255us/step - loss: 0.0135 - acc: 0.9994 - val_loss: 0.4773 - val_acc: 0.8618\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 257us/step - loss: 0.0107 - acc: 1.0000 - val_loss: 0.4993 - val_acc: 0.8548\n",
      "2-conv-128-nodes-0-dense-1544499645\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 1s 375us/step - loss: 0.7747 - acc: 0.6480 - val_loss: 0.5541 - val_acc: 0.7941\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 324us/step - loss: 0.4412 - acc: 0.8399 - val_loss: 0.4137 - val_acc: 0.8416\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 328us/step - loss: 0.3591 - acc: 0.8779 - val_loss: 0.3729 - val_acc: 0.8681\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 321us/step - loss: 0.3000 - acc: 0.8919 - val_loss: 0.4155 - val_acc: 0.8479\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 320us/step - loss: 0.2569 - acc: 0.9066 - val_loss: 0.3494 - val_acc: 0.8681\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 323us/step - loss: 0.2244 - acc: 0.9162 - val_loss: 0.4536 - val_acc: 0.8325\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 328us/step - loss: 0.1988 - acc: 0.9258 - val_loss: 0.3757 - val_acc: 0.8709\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 330us/step - loss: 0.1610 - acc: 0.9416 - val_loss: 0.3672 - val_acc: 0.8646\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 332us/step - loss: 0.1345 - acc: 0.9533 - val_loss: 0.3734 - val_acc: 0.8772\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 337us/step - loss: 0.1177 - acc: 0.9575 - val_loss: 0.4119 - val_acc: 0.8730\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 334us/step - loss: 0.0897 - acc: 0.9695 - val_loss: 0.4161 - val_acc: 0.8786\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 340us/step - loss: 0.0719 - acc: 0.9776 - val_loss: 0.4115 - val_acc: 0.8772\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 338us/step - loss: 0.0638 - acc: 0.9796 - val_loss: 0.4296 - val_acc: 0.8786\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 335us/step - loss: 0.0391 - acc: 0.9892 - val_loss: 0.4931 - val_acc: 0.8625\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 336us/step - loss: 0.0338 - acc: 0.9934 - val_loss: 0.4556 - val_acc: 0.8842\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 333us/step - loss: 0.0227 - acc: 0.9964 - val_loss: 0.4795 - val_acc: 0.8863\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 330us/step - loss: 0.0196 - acc: 0.9976 - val_loss: 0.4966 - val_acc: 0.8807\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 331us/step - loss: 0.0120 - acc: 0.9991 - val_loss: 0.5310 - val_acc: 0.8758\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 332us/step - loss: 0.0081 - acc: 0.9997 - val_loss: 0.5360 - val_acc: 0.8793\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 339us/step - loss: 0.0059 - acc: 1.0000 - val_loss: 0.5557 - val_acc: 0.8786\n",
      "3-conv-128-nodes-0-dense-1544499669\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 1s 404us/step - loss: 0.8239 - acc: 0.6115 - val_loss: 0.6672 - val_acc: 0.7244\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 330us/step - loss: 0.5384 - acc: 0.7839 - val_loss: 0.6984 - val_acc: 0.7062\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 343us/step - loss: 0.4083 - acc: 0.8408 - val_loss: 0.4155 - val_acc: 0.8479\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 359us/step - loss: 0.3489 - acc: 0.8704 - val_loss: 0.4051 - val_acc: 0.8472\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 364us/step - loss: 0.2897 - acc: 0.8925 - val_loss: 0.3847 - val_acc: 0.8514\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 360us/step - loss: 0.2555 - acc: 0.9009 - val_loss: 0.3596 - val_acc: 0.8660\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 361us/step - loss: 0.2018 - acc: 0.9273 - val_loss: 0.3385 - val_acc: 0.8835\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 363us/step - loss: 0.1706 - acc: 0.9374 - val_loss: 0.3860 - val_acc: 0.8576\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 364us/step - loss: 0.1358 - acc: 0.9527 - val_loss: 0.3460 - val_acc: 0.8870\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 370us/step - loss: 0.1106 - acc: 0.9620 - val_loss: 0.4472 - val_acc: 0.8493\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 364us/step - loss: 0.0778 - acc: 0.9773 - val_loss: 0.3604 - val_acc: 0.8981\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 364us/step - loss: 0.0518 - acc: 0.9862 - val_loss: 0.3730 - val_acc: 0.8911\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 360us/step - loss: 0.0357 - acc: 0.9925 - val_loss: 0.4002 - val_acc: 0.8974\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 356us/step - loss: 0.0324 - acc: 0.9931 - val_loss: 0.4224 - val_acc: 0.8981\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 362us/step - loss: 0.0375 - acc: 0.9874 - val_loss: 0.6154 - val_acc: 0.8444\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 351us/step - loss: 0.0339 - acc: 0.9892 - val_loss: 0.4579 - val_acc: 0.8821\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 346us/step - loss: 0.0224 - acc: 0.9949 - val_loss: 0.4682 - val_acc: 0.8939\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 353us/step - loss: 0.0073 - acc: 0.9997 - val_loss: 0.4967 - val_acc: 0.8981\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 361us/step - loss: 0.0049 - acc: 0.9994 - val_loss: 0.4963 - val_acc: 0.9009\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 356us/step - loss: 0.0024 - acc: 1.0000 - val_loss: 0.5161 - val_acc: 0.8981\n",
      "1-conv-256-nodes-0-dense-1544499694\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 1s 400us/step - loss: 0.7275 - acc: 0.6959 - val_loss: 0.4596 - val_acc: 0.8290\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 342us/step - loss: 0.3929 - acc: 0.8572 - val_loss: 0.4110 - val_acc: 0.8339\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 351us/step - loss: 0.2804 - acc: 0.8997 - val_loss: 0.3929 - val_acc: 0.8667\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 346us/step - loss: 0.2263 - acc: 0.9189 - val_loss: 0.3970 - val_acc: 0.8590\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 348us/step - loss: 0.1626 - acc: 0.9497 - val_loss: 0.3637 - val_acc: 0.8716\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 349us/step - loss: 0.1204 - acc: 0.9638 - val_loss: 0.4145 - val_acc: 0.8528\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 352us/step - loss: 0.0957 - acc: 0.9752 - val_loss: 0.4111 - val_acc: 0.8535\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 348us/step - loss: 0.0732 - acc: 0.9850 - val_loss: 0.3884 - val_acc: 0.8730\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 353us/step - loss: 0.0501 - acc: 0.9922 - val_loss: 0.3947 - val_acc: 0.8793\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 352us/step - loss: 0.0382 - acc: 0.9955 - val_loss: 0.4155 - val_acc: 0.8653\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 353us/step - loss: 0.0309 - acc: 0.9988 - val_loss: 0.4307 - val_acc: 0.8723\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 347us/step - loss: 0.0257 - acc: 0.9988 - val_loss: 0.4460 - val_acc: 0.8751\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 353us/step - loss: 0.0217 - acc: 0.9985 - val_loss: 0.4625 - val_acc: 0.8716\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 353us/step - loss: 0.0168 - acc: 0.9994 - val_loss: 0.4647 - val_acc: 0.8730\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 356us/step - loss: 0.0115 - acc: 1.0000 - val_loss: 0.4853 - val_acc: 0.8674\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 349us/step - loss: 0.0098 - acc: 1.0000 - val_loss: 0.4985 - val_acc: 0.8667\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 352us/step - loss: 0.0083 - acc: 1.0000 - val_loss: 0.5008 - val_acc: 0.8737\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 354us/step - loss: 0.0066 - acc: 1.0000 - val_loss: 0.5311 - val_acc: 0.8618\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 346us/step - loss: 0.0059 - acc: 1.0000 - val_loss: 0.5262 - val_acc: 0.8625\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 354us/step - loss: 0.0049 - acc: 1.0000 - val_loss: 0.5275 - val_acc: 0.8674\n",
      "2-conv-256-nodes-0-dense-1544499720\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 2s 572us/step - loss: 0.7320 - acc: 0.6672 - val_loss: 0.5225 - val_acc: 0.7872\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 2s 492us/step - loss: 0.4125 - acc: 0.8554 - val_loss: 0.3732 - val_acc: 0.8604\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 2s 487us/step - loss: 0.3083 - acc: 0.8919 - val_loss: 0.3779 - val_acc: 0.8493\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 2s 494us/step - loss: 0.2653 - acc: 0.9051 - val_loss: 0.3355 - val_acc: 0.8772\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 2s 494us/step - loss: 0.2250 - acc: 0.9156 - val_loss: 0.3456 - val_acc: 0.8744\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 2s 495us/step - loss: 0.1916 - acc: 0.9288 - val_loss: 0.3628 - val_acc: 0.8716\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 2s 491us/step - loss: 0.1446 - acc: 0.9473 - val_loss: 0.3733 - val_acc: 0.8660\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 2s 481us/step - loss: 0.1063 - acc: 0.9611 - val_loss: 0.3942 - val_acc: 0.8758\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 2s 475us/step - loss: 0.0748 - acc: 0.9793 - val_loss: 0.4237 - val_acc: 0.8800\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 2s 472us/step - loss: 0.0586 - acc: 0.9814 - val_loss: 0.3865 - val_acc: 0.8800\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 2s 478us/step - loss: 0.0424 - acc: 0.9892 - val_loss: 0.4442 - val_acc: 0.8786\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 2s 488us/step - loss: 0.0448 - acc: 0.9880 - val_loss: 0.4206 - val_acc: 0.8876\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 2s 489us/step - loss: 0.0279 - acc: 0.9943 - val_loss: 0.4773 - val_acc: 0.8828\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 2s 490us/step - loss: 0.0163 - acc: 0.9982 - val_loss: 0.4693 - val_acc: 0.8842\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 2s 493us/step - loss: 0.0086 - acc: 0.9994 - val_loss: 0.5074 - val_acc: 0.8856\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 2s 487us/step - loss: 0.0053 - acc: 1.0000 - val_loss: 0.5137 - val_acc: 0.8876\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 2s 481us/step - loss: 0.0030 - acc: 1.0000 - val_loss: 0.5527 - val_acc: 0.8849\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 2s 480us/step - loss: 0.0023 - acc: 1.0000 - val_loss: 0.5610 - val_acc: 0.8842\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 2s 488us/step - loss: 0.0019 - acc: 1.0000 - val_loss: 0.5671 - val_acc: 0.8828\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 2s 490us/step - loss: 0.0015 - acc: 1.0000 - val_loss: 0.5951 - val_acc: 0.8849\n",
      "3-conv-256-nodes-0-dense-1544499754\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 2s 606us/step - loss: 0.7798 - acc: 0.6292 - val_loss: 0.6509 - val_acc: 0.7306\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 2s 540us/step - loss: 0.5004 - acc: 0.8057 - val_loss: 0.4994 - val_acc: 0.8025\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 2s 547us/step - loss: 0.4153 - acc: 0.8411 - val_loss: 0.6167 - val_acc: 0.7739\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 2s 523us/step - loss: 0.3369 - acc: 0.8782 - val_loss: 0.3958 - val_acc: 0.8507\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 2s 528us/step - loss: 0.2735 - acc: 0.8994 - val_loss: 0.3380 - val_acc: 0.8772\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 2s 530us/step - loss: 0.2399 - acc: 0.9117 - val_loss: 0.3797 - val_acc: 0.8660\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 2s 548us/step - loss: 0.1718 - acc: 0.9362 - val_loss: 0.3448 - val_acc: 0.8772\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 2s 559us/step - loss: 0.1498 - acc: 0.9461 - val_loss: 0.3333 - val_acc: 0.8821\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 2s 557us/step - loss: 0.0976 - acc: 0.9701 - val_loss: 0.3674 - val_acc: 0.8828\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 2s 561us/step - loss: 0.0684 - acc: 0.9784 - val_loss: 0.3508 - val_acc: 0.8870\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 2s 548us/step - loss: 0.0713 - acc: 0.9767 - val_loss: 0.3645 - val_acc: 0.8904\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 2s 544us/step - loss: 0.0436 - acc: 0.9874 - val_loss: 0.3925 - val_acc: 0.9002\n",
      "Epoch 13/20\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "3341/3341 [==============================] - 2s 548us/step - loss: 0.0155 - acc: 0.9973 - val_loss: 0.4345 - val_acc: 0.8870\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 2s 548us/step - loss: 0.0115 - acc: 0.9985 - val_loss: 0.4490 - val_acc: 0.8911\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 2s 551us/step - loss: 0.0037 - acc: 0.9997 - val_loss: 0.4663 - val_acc: 0.9065\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 2s 539us/step - loss: 0.0037 - acc: 0.9997 - val_loss: 0.4855 - val_acc: 0.8960\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 2s 554us/step - loss: 0.0028 - acc: 0.9997 - val_loss: 0.4997 - val_acc: 0.8974\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 2s 559us/step - loss: 0.0012 - acc: 0.9997 - val_loss: 0.5191 - val_acc: 0.9072\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 2s 545us/step - loss: 0.0011 - acc: 1.0000 - val_loss: 0.5334 - val_acc: 0.9023\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 2s 541us/step - loss: 5.4856e-04 - acc: 1.0000 - val_loss: 0.5401 - val_acc: 0.9030\n",
      "1-conv-32-nodes-1-dense-1544499793\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 1s 328us/step - loss: 0.8329 - acc: 0.6112 - val_loss: 0.5892 - val_acc: 0.7725\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 259us/step - loss: 0.5067 - acc: 0.8066 - val_loss: 0.5009 - val_acc: 0.8179\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 268us/step - loss: 0.4090 - acc: 0.8506 - val_loss: 0.5106 - val_acc: 0.8004\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 262us/step - loss: 0.3411 - acc: 0.8812 - val_loss: 0.4070 - val_acc: 0.8472\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 260us/step - loss: 0.2830 - acc: 0.9009 - val_loss: 0.4067 - val_acc: 0.8381\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 262us/step - loss: 0.2468 - acc: 0.9195 - val_loss: 0.4498 - val_acc: 0.8200\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 257us/step - loss: 0.2140 - acc: 0.9282 - val_loss: 0.3751 - val_acc: 0.8618\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 258us/step - loss: 0.1882 - acc: 0.9407 - val_loss: 0.3807 - val_acc: 0.8611\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 260us/step - loss: 0.1579 - acc: 0.9542 - val_loss: 0.4443 - val_acc: 0.8367\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 261us/step - loss: 0.1372 - acc: 0.9575 - val_loss: 0.3798 - val_acc: 0.8625\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 260us/step - loss: 0.1175 - acc: 0.9668 - val_loss: 0.3794 - val_acc: 0.8688\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 261us/step - loss: 0.0943 - acc: 0.9779 - val_loss: 0.4174 - val_acc: 0.8625\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 262us/step - loss: 0.0744 - acc: 0.9859 - val_loss: 0.4494 - val_acc: 0.8569\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 270us/step - loss: 0.0656 - acc: 0.9862 - val_loss: 0.4046 - val_acc: 0.8702\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 255us/step - loss: 0.0566 - acc: 0.9904 - val_loss: 0.4177 - val_acc: 0.8709\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 248us/step - loss: 0.0440 - acc: 0.9940 - val_loss: 0.4279 - val_acc: 0.8653\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 264us/step - loss: 0.0465 - acc: 0.9913 - val_loss: 0.4908 - val_acc: 0.8500\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 273us/step - loss: 0.0463 - acc: 0.9904 - val_loss: 0.4558 - val_acc: 0.8653\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 267us/step - loss: 0.0321 - acc: 0.9955 - val_loss: 0.4804 - val_acc: 0.8646\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 274us/step - loss: 0.0229 - acc: 0.9982 - val_loss: 0.4902 - val_acc: 0.8660\n",
      "2-conv-32-nodes-1-dense-1544499812\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 1s 356us/step - loss: 0.8497 - acc: 0.6046 - val_loss: 0.6128 - val_acc: 0.7579\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 275us/step - loss: 0.5272 - acc: 0.7986 - val_loss: 0.5002 - val_acc: 0.8018\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 305us/step - loss: 0.4365 - acc: 0.8363 - val_loss: 0.4297 - val_acc: 0.8402\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 316us/step - loss: 0.3718 - acc: 0.8608 - val_loss: 0.4115 - val_acc: 0.8451\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 299us/step - loss: 0.3255 - acc: 0.8788 - val_loss: 0.4170 - val_acc: 0.8444\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 297us/step - loss: 0.2812 - acc: 0.8997 - val_loss: 0.3857 - val_acc: 0.8653\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 294us/step - loss: 0.2560 - acc: 0.9054 - val_loss: 0.3729 - val_acc: 0.8611\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 292us/step - loss: 0.2363 - acc: 0.9084 - val_loss: 0.3904 - val_acc: 0.8521\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 302us/step - loss: 0.2172 - acc: 0.9180 - val_loss: 0.3741 - val_acc: 0.8737\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 319us/step - loss: 0.1953 - acc: 0.9267 - val_loss: 0.3688 - val_acc: 0.8772\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 316us/step - loss: 0.1875 - acc: 0.9261 - val_loss: 0.3499 - val_acc: 0.8723\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 306us/step - loss: 0.1607 - acc: 0.9404 - val_loss: 0.3926 - val_acc: 0.8653\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 291us/step - loss: 0.1468 - acc: 0.9443 - val_loss: 0.4015 - val_acc: 0.8688\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 316us/step - loss: 0.1301 - acc: 0.9521 - val_loss: 0.3610 - val_acc: 0.8800\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 317us/step - loss: 0.1151 - acc: 0.9584 - val_loss: 0.4148 - val_acc: 0.8716\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 319us/step - loss: 0.0981 - acc: 0.9653 - val_loss: 0.3821 - val_acc: 0.8821\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 319us/step - loss: 0.0847 - acc: 0.9731 - val_loss: 0.4372 - val_acc: 0.8751\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 318us/step - loss: 0.0702 - acc: 0.9767 - val_loss: 0.4038 - val_acc: 0.8883\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 326us/step - loss: 0.0617 - acc: 0.9793 - val_loss: 0.4179 - val_acc: 0.8807\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 310us/step - loss: 0.0520 - acc: 0.9856 - val_loss: 0.4881 - val_acc: 0.8702\n",
      "3-conv-32-nodes-1-dense-1544499835\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 1s 409us/step - loss: 0.8830 - acc: 0.5663 - val_loss: 0.7093 - val_acc: 0.7104\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 332us/step - loss: 0.6200 - acc: 0.7552 - val_loss: 0.5336 - val_acc: 0.7906\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 357us/step - loss: 0.5133 - acc: 0.8043 - val_loss: 0.6005 - val_acc: 0.7355\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 353us/step - loss: 0.4791 - acc: 0.8198 - val_loss: 0.5409 - val_acc: 0.7802\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 357us/step - loss: 0.4331 - acc: 0.8357 - val_loss: 0.4421 - val_acc: 0.8346\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 332us/step - loss: 0.4062 - acc: 0.8441 - val_loss: 0.5174 - val_acc: 0.7983\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 350us/step - loss: 0.3942 - acc: 0.8488 - val_loss: 0.4348 - val_acc: 0.8241\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 334us/step - loss: 0.3457 - acc: 0.8674 - val_loss: 0.4010 - val_acc: 0.8514\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 335us/step - loss: 0.3146 - acc: 0.8845 - val_loss: 0.3747 - val_acc: 0.8583\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 329us/step - loss: 0.2947 - acc: 0.8928 - val_loss: 0.3793 - val_acc: 0.8569\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 348us/step - loss: 0.2734 - acc: 0.8976 - val_loss: 0.3525 - val_acc: 0.8730\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 345us/step - loss: 0.2440 - acc: 0.9126 - val_loss: 0.3448 - val_acc: 0.8695\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 341us/step - loss: 0.2432 - acc: 0.9075 - val_loss: 0.3722 - val_acc: 0.8660\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 344us/step - loss: 0.2032 - acc: 0.9273 - val_loss: 0.3795 - val_acc: 0.8618\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 342us/step - loss: 0.1972 - acc: 0.9264 - val_loss: 0.3601 - val_acc: 0.8723\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 344us/step - loss: 0.2029 - acc: 0.9225 - val_loss: 0.3541 - val_acc: 0.8681\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 366us/step - loss: 0.1644 - acc: 0.9377 - val_loss: 0.3604 - val_acc: 0.8807\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 365us/step - loss: 0.1527 - acc: 0.9449 - val_loss: 0.3445 - val_acc: 0.8932\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 355us/step - loss: 0.1451 - acc: 0.9461 - val_loss: 0.3768 - val_acc: 0.8814\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 332us/step - loss: 0.1336 - acc: 0.9527 - val_loss: 0.4550 - val_acc: 0.8458\n",
      "1-conv-64-nodes-1-dense-1544499860\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 1s 360us/step - loss: 0.6746 - acc: 0.7052 - val_loss: 0.4596 - val_acc: 0.8311\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 287us/step - loss: 0.3720 - acc: 0.8683 - val_loss: 0.4218 - val_acc: 0.8486\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 295us/step - loss: 0.2669 - acc: 0.9042 - val_loss: 0.3507 - val_acc: 0.8709\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 292us/step - loss: 0.1997 - acc: 0.9288 - val_loss: 0.4995 - val_acc: 0.8234\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 282us/step - loss: 0.1335 - acc: 0.9629 - val_loss: 0.3843 - val_acc: 0.8702\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 291us/step - loss: 0.0893 - acc: 0.9743 - val_loss: 0.4117 - val_acc: 0.8548\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 282us/step - loss: 0.0677 - acc: 0.9850 - val_loss: 0.4149 - val_acc: 0.8667\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 279us/step - loss: 0.0430 - acc: 0.9916 - val_loss: 0.3923 - val_acc: 0.8814\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 276us/step - loss: 0.0323 - acc: 0.9961 - val_loss: 0.4211 - val_acc: 0.8758\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 280us/step - loss: 0.0257 - acc: 0.9958 - val_loss: 0.4714 - val_acc: 0.8555\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 275us/step - loss: 0.0188 - acc: 0.9985 - val_loss: 0.4321 - val_acc: 0.8772\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 275us/step - loss: 0.0093 - acc: 1.0000 - val_loss: 0.4527 - val_acc: 0.8744\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 289us/step - loss: 0.0066 - acc: 1.0000 - val_loss: 0.4626 - val_acc: 0.8758\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 295us/step - loss: 0.0051 - acc: 1.0000 - val_loss: 0.4791 - val_acc: 0.8765\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 296us/step - loss: 0.0040 - acc: 1.0000 - val_loss: 0.4847 - val_acc: 0.8765\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 300us/step - loss: 0.0033 - acc: 1.0000 - val_loss: 0.4939 - val_acc: 0.8772\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 302us/step - loss: 0.0028 - acc: 1.0000 - val_loss: 0.5032 - val_acc: 0.8814\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 300us/step - loss: 0.0023 - acc: 1.0000 - val_loss: 0.5184 - val_acc: 0.8793\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 295us/step - loss: 0.0020 - acc: 1.0000 - val_loss: 0.5158 - val_acc: 0.8821\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 289us/step - loss: 0.0018 - acc: 1.0000 - val_loss: 0.5240 - val_acc: 0.8800\n",
      "2-conv-64-nodes-1-dense-1544499882\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 1s 381us/step - loss: 0.7561 - acc: 0.6717 - val_loss: 0.5373 - val_acc: 0.7837\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 301us/step - loss: 0.4434 - acc: 0.8366 - val_loss: 0.4381 - val_acc: 0.8437\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 314us/step - loss: 0.3524 - acc: 0.8677 - val_loss: 0.3988 - val_acc: 0.8430\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 319us/step - loss: 0.2990 - acc: 0.8878 - val_loss: 0.3421 - val_acc: 0.8695\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 329us/step - loss: 0.2585 - acc: 0.9048 - val_loss: 0.3648 - val_acc: 0.8555\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 310us/step - loss: 0.1999 - acc: 0.9309 - val_loss: 0.3538 - val_acc: 0.8828\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 322us/step - loss: 0.1693 - acc: 0.9350 - val_loss: 0.7078 - val_acc: 0.7648\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 318us/step - loss: 0.1574 - acc: 0.9428 - val_loss: 0.3461 - val_acc: 0.8807\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 319us/step - loss: 0.0972 - acc: 0.9626 - val_loss: 0.4034 - val_acc: 0.8723\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 321us/step - loss: 0.0812 - acc: 0.9716 - val_loss: 0.4013 - val_acc: 0.8835\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 331us/step - loss: 0.0607 - acc: 0.9817 - val_loss: 0.4115 - val_acc: 0.8842\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 328us/step - loss: 0.0361 - acc: 0.9919 - val_loss: 0.4673 - val_acc: 0.8744\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 324us/step - loss: 0.0263 - acc: 0.9940 - val_loss: 0.4548 - val_acc: 0.8772\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 312us/step - loss: 0.0161 - acc: 0.9985 - val_loss: 0.4685 - val_acc: 0.9016\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 313us/step - loss: 0.0100 - acc: 0.9991 - val_loss: 0.4902 - val_acc: 0.8890\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 320us/step - loss: 0.0058 - acc: 1.0000 - val_loss: 0.5244 - val_acc: 0.8897\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 319us/step - loss: 0.0033 - acc: 1.0000 - val_loss: 0.5435 - val_acc: 0.8849\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 319us/step - loss: 0.0025 - acc: 1.0000 - val_loss: 0.5553 - val_acc: 0.8911\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 320us/step - loss: 0.0018 - acc: 1.0000 - val_loss: 0.5628 - val_acc: 0.8911\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 323us/step - loss: 0.0015 - acc: 1.0000 - val_loss: 0.5831 - val_acc: 0.8890\n",
      "3-conv-64-nodes-1-dense-1544499905\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 1s 430us/step - loss: 0.8313 - acc: 0.6055 - val_loss: 0.6903 - val_acc: 0.7041\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 343us/step - loss: 0.5951 - acc: 0.7573 - val_loss: 0.5699 - val_acc: 0.7488\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 367us/step - loss: 0.4497 - acc: 0.8258 - val_loss: 0.4603 - val_acc: 0.8262\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 362us/step - loss: 0.3732 - acc: 0.8569 - val_loss: 0.4055 - val_acc: 0.8465\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 355us/step - loss: 0.3208 - acc: 0.8788 - val_loss: 0.3657 - val_acc: 0.8618\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 358us/step - loss: 0.2803 - acc: 0.8991 - val_loss: 0.3640 - val_acc: 0.8597\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 365us/step - loss: 0.2418 - acc: 0.9099 - val_loss: 0.3318 - val_acc: 0.8737\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 357us/step - loss: 0.1996 - acc: 0.9285 - val_loss: 0.3126 - val_acc: 0.8904\n",
      "Epoch 9/20\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "3341/3341 [==============================] - 1s 361us/step - loss: 0.1816 - acc: 0.9342 - val_loss: 0.3350 - val_acc: 0.8765\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 357us/step - loss: 0.1502 - acc: 0.9443 - val_loss: 0.3459 - val_acc: 0.8932\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 363us/step - loss: 0.1258 - acc: 0.9554 - val_loss: 0.3597 - val_acc: 0.8870\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 352us/step - loss: 0.0936 - acc: 0.9677 - val_loss: 0.3678 - val_acc: 0.8876\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 351us/step - loss: 0.0941 - acc: 0.9638 - val_loss: 0.3858 - val_acc: 0.8786\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 359us/step - loss: 0.1033 - acc: 0.9617 - val_loss: 0.4293 - val_acc: 0.8807\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 365us/step - loss: 0.0430 - acc: 0.9871 - val_loss: 0.4450 - val_acc: 0.8953\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 360us/step - loss: 0.0337 - acc: 0.9910 - val_loss: 0.4922 - val_acc: 0.8835\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 359us/step - loss: 0.0643 - acc: 0.9773 - val_loss: 0.4725 - val_acc: 0.8904\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 370us/step - loss: 0.0179 - acc: 0.9967 - val_loss: 0.4893 - val_acc: 0.8876\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 361us/step - loss: 0.0134 - acc: 0.9979 - val_loss: 0.5056 - val_acc: 0.8904\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 354us/step - loss: 0.0046 - acc: 1.0000 - val_loss: 0.5704 - val_acc: 0.8946\n",
      "1-conv-128-nodes-1-dense-1544499932\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 2s 509us/step - loss: 0.7855 - acc: 0.6839 - val_loss: 0.4917 - val_acc: 0.8200\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 418us/step - loss: 0.3800 - acc: 0.8620 - val_loss: 0.4008 - val_acc: 0.8514\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 430us/step - loss: 0.2469 - acc: 0.9084 - val_loss: 0.4733 - val_acc: 0.8255\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 427us/step - loss: 0.1470 - acc: 0.9518 - val_loss: 0.3647 - val_acc: 0.8779\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 430us/step - loss: 0.1022 - acc: 0.9683 - val_loss: 0.4273 - val_acc: 0.8576\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 434us/step - loss: 0.0565 - acc: 0.9904 - val_loss: 0.4588 - val_acc: 0.8507\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 436us/step - loss: 0.0344 - acc: 0.9946 - val_loss: 0.4058 - val_acc: 0.8814\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 438us/step - loss: 0.0231 - acc: 0.9970 - val_loss: 0.4453 - val_acc: 0.8765\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 442us/step - loss: 0.0130 - acc: 0.9991 - val_loss: 0.4624 - val_acc: 0.8709\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 442us/step - loss: 0.0064 - acc: 1.0000 - val_loss: 0.4763 - val_acc: 0.8737\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 440us/step - loss: 0.0042 - acc: 1.0000 - val_loss: 0.4865 - val_acc: 0.8751\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 425us/step - loss: 0.0031 - acc: 1.0000 - val_loss: 0.5117 - val_acc: 0.8702\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 424us/step - loss: 0.0023 - acc: 1.0000 - val_loss: 0.5147 - val_acc: 0.8737\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 423us/step - loss: 0.0020 - acc: 1.0000 - val_loss: 0.5211 - val_acc: 0.8751\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 428us/step - loss: 0.0016 - acc: 1.0000 - val_loss: 0.5443 - val_acc: 0.8716\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 423us/step - loss: 0.0013 - acc: 1.0000 - val_loss: 0.5454 - val_acc: 0.8737\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 437us/step - loss: 0.0011 - acc: 1.0000 - val_loss: 0.5463 - val_acc: 0.8758\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 446us/step - loss: 9.2924e-04 - acc: 1.0000 - val_loss: 0.5612 - val_acc: 0.8730\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 444us/step - loss: 8.2239e-04 - acc: 1.0000 - val_loss: 0.5746 - val_acc: 0.8723\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 437us/step - loss: 6.8623e-04 - acc: 1.0000 - val_loss: 0.5905 - val_acc: 0.8660\n",
      "2-conv-128-nodes-1-dense-1544499964\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 2s 457us/step - loss: 0.6895 - acc: 0.6848 - val_loss: 0.4560 - val_acc: 0.8262\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 370us/step - loss: 0.3731 - acc: 0.8596 - val_loss: 0.3615 - val_acc: 0.8702\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 392us/step - loss: 0.2934 - acc: 0.8908 - val_loss: 0.3824 - val_acc: 0.8590\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 388us/step - loss: 0.2516 - acc: 0.9054 - val_loss: 0.3878 - val_acc: 0.8535\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 387us/step - loss: 0.1834 - acc: 0.9300 - val_loss: 0.3438 - val_acc: 0.8842\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 378us/step - loss: 0.1405 - acc: 0.9485 - val_loss: 0.3947 - val_acc: 0.8625\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 382us/step - loss: 0.0902 - acc: 0.9689 - val_loss: 0.3705 - val_acc: 0.8856\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 382us/step - loss: 0.0799 - acc: 0.9725 - val_loss: 0.3894 - val_acc: 0.8814\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 370us/step - loss: 0.0663 - acc: 0.9761 - val_loss: 0.4364 - val_acc: 0.8709\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 378us/step - loss: 0.0406 - acc: 0.9868 - val_loss: 0.5052 - val_acc: 0.8751\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 374us/step - loss: 0.0359 - acc: 0.9886 - val_loss: 0.4552 - val_acc: 0.8849\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 388us/step - loss: 0.0287 - acc: 0.9928 - val_loss: 0.4544 - val_acc: 0.8918\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 384us/step - loss: 0.0128 - acc: 0.9967 - val_loss: 0.5223 - val_acc: 0.8904\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 378us/step - loss: 0.0043 - acc: 0.9997 - val_loss: 0.5421 - val_acc: 0.8911\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 381us/step - loss: 0.0015 - acc: 1.0000 - val_loss: 0.5708 - val_acc: 0.8904\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 381us/step - loss: 9.2688e-04 - acc: 1.0000 - val_loss: 0.5915 - val_acc: 0.8911\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 377us/step - loss: 6.8081e-04 - acc: 1.0000 - val_loss: 0.5948 - val_acc: 0.8939\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 384us/step - loss: 5.4635e-04 - acc: 1.0000 - val_loss: 0.6050 - val_acc: 0.8946\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 375us/step - loss: 4.5263e-04 - acc: 1.0000 - val_loss: 0.6208 - val_acc: 0.8953\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 377us/step - loss: 3.9393e-04 - acc: 1.0000 - val_loss: 0.6269 - val_acc: 0.8946\n",
      "3-conv-128-nodes-1-dense-1544499992\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 2s 502us/step - loss: 0.8013 - acc: 0.6280 - val_loss: 0.6033 - val_acc: 0.7467\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 380us/step - loss: 0.5102 - acc: 0.7983 - val_loss: 0.4624 - val_acc: 0.8339\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 388us/step - loss: 0.3977 - acc: 0.8491 - val_loss: 0.4350 - val_acc: 0.8325\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 392us/step - loss: 0.3404 - acc: 0.8755 - val_loss: 0.4876 - val_acc: 0.8193\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 407us/step - loss: 0.2809 - acc: 0.8970 - val_loss: 0.3570 - val_acc: 0.8653\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 419us/step - loss: 0.2305 - acc: 0.9135 - val_loss: 0.3151 - val_acc: 0.8925\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 413us/step - loss: 0.1926 - acc: 0.9330 - val_loss: 0.3248 - val_acc: 0.8897\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 421us/step - loss: 0.1593 - acc: 0.9395 - val_loss: 0.3361 - val_acc: 0.8953\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 423us/step - loss: 0.1526 - acc: 0.9446 - val_loss: 0.3502 - val_acc: 0.8925\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 421us/step - loss: 0.1041 - acc: 0.9626 - val_loss: 0.4602 - val_acc: 0.8674\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 423us/step - loss: 0.0576 - acc: 0.9835 - val_loss: 0.3967 - val_acc: 0.8939\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 424us/step - loss: 0.0581 - acc: 0.9796 - val_loss: 0.4170 - val_acc: 0.8918\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 422us/step - loss: 0.0376 - acc: 0.9877 - val_loss: 0.5120 - val_acc: 0.8814\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 410us/step - loss: 0.0246 - acc: 0.9928 - val_loss: 0.4786 - val_acc: 0.8918\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 402us/step - loss: 0.0118 - acc: 0.9970 - val_loss: 0.5381 - val_acc: 0.8925\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 407us/step - loss: 0.0644 - acc: 0.9773 - val_loss: 0.5416 - val_acc: 0.8786\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 403us/step - loss: 0.0237 - acc: 0.9922 - val_loss: 0.5415 - val_acc: 0.8911\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 415us/step - loss: 0.0176 - acc: 0.9943 - val_loss: 0.6092 - val_acc: 0.8793\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 412us/step - loss: 0.0135 - acc: 0.9958 - val_loss: 0.9749 - val_acc: 0.8276\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 404us/step - loss: 0.0697 - acc: 0.9776 - val_loss: 0.5042 - val_acc: 0.8995\n",
      "1-conv-256-nodes-1-dense-1544500022\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 3s 1ms/step - loss: 0.7987 - acc: 0.7240 - val_loss: 0.4471 - val_acc: 0.8255\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 3s 919us/step - loss: 0.2937 - acc: 0.8931 - val_loss: 0.3746 - val_acc: 0.8632\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 3s 923us/step - loss: 0.1640 - acc: 0.9434 - val_loss: 0.3767 - val_acc: 0.8681\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 3s 931us/step - loss: 0.1170 - acc: 0.9623 - val_loss: 0.5779 - val_acc: 0.8248\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 3s 920us/step - loss: 0.0795 - acc: 0.9793 - val_loss: 0.4371 - val_acc: 0.8639\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 3s 918us/step - loss: 0.0280 - acc: 0.9949 - val_loss: 0.4943 - val_acc: 0.8660\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 3s 918us/step - loss: 0.0130 - acc: 0.9991 - val_loss: 0.5007 - val_acc: 0.8772\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 3s 916us/step - loss: 0.0066 - acc: 1.0000 - val_loss: 0.5401 - val_acc: 0.8653\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 3s 915us/step - loss: 0.0058 - acc: 0.9997 - val_loss: 0.5589 - val_acc: 0.8660\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 3s 917us/step - loss: 0.0025 - acc: 1.0000 - val_loss: 0.5572 - val_acc: 0.8716\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 3s 915us/step - loss: 0.0016 - acc: 1.0000 - val_loss: 0.5663 - val_acc: 0.8695\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 3s 921us/step - loss: 0.0012 - acc: 1.0000 - val_loss: 0.5813 - val_acc: 0.8716\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 3s 915us/step - loss: 9.8301e-04 - acc: 1.0000 - val_loss: 0.5847 - val_acc: 0.8688\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 3s 921us/step - loss: 7.9268e-04 - acc: 1.0000 - val_loss: 0.6067 - val_acc: 0.8723\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 3s 921us/step - loss: 6.7754e-04 - acc: 1.0000 - val_loss: 0.6084 - val_acc: 0.8709\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 3s 921us/step - loss: 5.5234e-04 - acc: 1.0000 - val_loss: 0.6175 - val_acc: 0.8688\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 3s 920us/step - loss: 4.8455e-04 - acc: 1.0000 - val_loss: 0.6235 - val_acc: 0.8695\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 3s 918us/step - loss: 4.3030e-04 - acc: 1.0000 - val_loss: 0.6394 - val_acc: 0.8702\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 3s 922us/step - loss: 3.5920e-04 - acc: 1.0000 - val_loss: 0.6349 - val_acc: 0.8695\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 3s 919us/step - loss: 3.1519e-04 - acc: 1.0000 - val_loss: 0.6453 - val_acc: 0.8674\n",
      "2-conv-256-nodes-1-dense-1544500088\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 2s 723us/step - loss: 0.6794 - acc: 0.7142 - val_loss: 0.5071 - val_acc: 0.8165\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 2s 630us/step - loss: 0.3847 - acc: 0.8557 - val_loss: 0.3526 - val_acc: 0.8590\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 2s 640us/step - loss: 0.2888 - acc: 0.8928 - val_loss: 0.3375 - val_acc: 0.8716\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 2s 637us/step - loss: 0.2202 - acc: 0.9168 - val_loss: 0.3247 - val_acc: 0.8828\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 2s 636us/step - loss: 0.1802 - acc: 0.9306 - val_loss: 0.3203 - val_acc: 0.8793\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 2s 634us/step - loss: 0.1352 - acc: 0.9485 - val_loss: 0.3970 - val_acc: 0.8618\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 2s 637us/step - loss: 0.1088 - acc: 0.9626 - val_loss: 0.4657 - val_acc: 0.8562\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 2s 642us/step - loss: 0.1011 - acc: 0.9596 - val_loss: 0.3585 - val_acc: 0.8904\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 2s 641us/step - loss: 0.0421 - acc: 0.9871 - val_loss: 0.4203 - val_acc: 0.8821\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 2s 647us/step - loss: 0.0265 - acc: 0.9931 - val_loss: 0.4752 - val_acc: 0.8939\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 2s 615us/step - loss: 0.0399 - acc: 0.9868 - val_loss: 0.5017 - val_acc: 0.8828\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 2s 603us/step - loss: 0.0085 - acc: 0.9985 - val_loss: 0.5852 - val_acc: 0.8758\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 2s 604us/step - loss: 0.0193 - acc: 0.9952 - val_loss: 0.5929 - val_acc: 0.8807\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 2s 606us/step - loss: 0.0134 - acc: 0.9961 - val_loss: 0.5154 - val_acc: 0.8953\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 2s 599us/step - loss: 0.0185 - acc: 0.9925 - val_loss: 0.6216 - val_acc: 0.8828\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 2s 604us/step - loss: 0.0131 - acc: 0.9952 - val_loss: 0.7639 - val_acc: 0.8562\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 2s 624us/step - loss: 0.0424 - acc: 0.9859 - val_loss: 0.5847 - val_acc: 0.8828\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 2s 634us/step - loss: 0.0332 - acc: 0.9862 - val_loss: 0.6384 - val_acc: 0.8730\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 2s 631us/step - loss: 0.0217 - acc: 0.9937 - val_loss: 0.6705 - val_acc: 0.8758\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 2s 618us/step - loss: 0.0218 - acc: 0.9922 - val_loss: 0.6081 - val_acc: 0.8870\n",
      "3-conv-256-nodes-1-dense-1544500133\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 2s 688us/step - loss: 0.8090 - acc: 0.6229 - val_loss: 0.6928 - val_acc: 0.7167\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 2s 592us/step - loss: 0.5541 - acc: 0.7854 - val_loss: 0.5247 - val_acc: 0.7906\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 2s 597us/step - loss: 0.4330 - acc: 0.8420 - val_loss: 0.4548 - val_acc: 0.8297\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 2s 603us/step - loss: 0.3487 - acc: 0.8752 - val_loss: 0.4728 - val_acc: 0.8144\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 2s 589us/step - loss: 0.2972 - acc: 0.8899 - val_loss: 0.3537 - val_acc: 0.8625\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 2s 572us/step - loss: 0.2256 - acc: 0.9132 - val_loss: 0.3417 - val_acc: 0.8751\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 2s 573us/step - loss: 0.1731 - acc: 0.9291 - val_loss: 0.3879 - val_acc: 0.8639\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 2s 612us/step - loss: 0.1359 - acc: 0.9464 - val_loss: 0.5061 - val_acc: 0.8451\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 2s 609us/step - loss: 0.0907 - acc: 0.9677 - val_loss: 0.4219 - val_acc: 0.8772\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 2s 591us/step - loss: 0.0523 - acc: 0.9835 - val_loss: 0.5214 - val_acc: 0.8709\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 2s 606us/step - loss: 0.0490 - acc: 0.9802 - val_loss: 0.4676 - val_acc: 0.8779\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 2s 605us/step - loss: 0.0252 - acc: 0.9922 - val_loss: 0.5369 - val_acc: 0.8751\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 2s 625us/step - loss: 0.0413 - acc: 0.9868 - val_loss: 0.5328 - val_acc: 0.8716\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 2s 608us/step - loss: 0.0365 - acc: 0.9880 - val_loss: 0.5255 - val_acc: 0.8772\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 2s 609us/step - loss: 0.0785 - acc: 0.9784 - val_loss: 0.6161 - val_acc: 0.8667\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 2s 608us/step - loss: 0.0165 - acc: 0.9958 - val_loss: 0.6512 - val_acc: 0.8709\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 2s 603us/step - loss: 0.0373 - acc: 0.9883 - val_loss: 0.5442 - val_acc: 0.8918\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 2s 604us/step - loss: 0.0294 - acc: 0.9910 - val_loss: 0.5769 - val_acc: 0.8793\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 2s 609us/step - loss: 0.0059 - acc: 0.9988 - val_loss: 0.6734 - val_acc: 0.8870\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 2s 606us/step - loss: 7.2345e-04 - acc: 1.0000 - val_loss: 0.6535 - val_acc: 0.8897\n",
      "1-conv-32-nodes-2-dense-1544500177\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 1s 388us/step - loss: 0.7629 - acc: 0.6576 - val_loss: 0.6385 - val_acc: 0.7502\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 281us/step - loss: 0.4429 - acc: 0.8318 - val_loss: 0.4814 - val_acc: 0.8144\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 307us/step - loss: 0.3199 - acc: 0.8830 - val_loss: 0.3822 - val_acc: 0.8604\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 312us/step - loss: 0.2708 - acc: 0.9057 - val_loss: 0.3798 - val_acc: 0.8632\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 308us/step - loss: 0.2006 - acc: 0.9324 - val_loss: 0.3778 - val_acc: 0.8583\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 299us/step - loss: 0.1443 - acc: 0.9542 - val_loss: 0.4350 - val_acc: 0.8423\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 299us/step - loss: 0.1129 - acc: 0.9668 - val_loss: 0.4209 - val_acc: 0.8576\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 310us/step - loss: 0.0701 - acc: 0.9832 - val_loss: 0.4077 - val_acc: 0.8674\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 307us/step - loss: 0.0447 - acc: 0.9919 - val_loss: 0.4321 - val_acc: 0.8625\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 311us/step - loss: 0.0359 - acc: 0.9943 - val_loss: 0.4508 - val_acc: 0.8723\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 311us/step - loss: 0.0228 - acc: 0.9982 - val_loss: 0.4637 - val_acc: 0.8681\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 306us/step - loss: 0.0156 - acc: 0.9991 - val_loss: 0.4924 - val_acc: 0.8667\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 300us/step - loss: 0.0102 - acc: 1.0000 - val_loss: 0.5208 - val_acc: 0.8702\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 297us/step - loss: 0.0082 - acc: 1.0000 - val_loss: 0.5354 - val_acc: 0.8674\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 306us/step - loss: 0.0064 - acc: 1.0000 - val_loss: 0.5605 - val_acc: 0.8674\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 320us/step - loss: 0.0043 - acc: 1.0000 - val_loss: 0.5828 - val_acc: 0.8688\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 307us/step - loss: 0.0037 - acc: 1.0000 - val_loss: 0.5834 - val_acc: 0.8674\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 305us/step - loss: 0.0027 - acc: 1.0000 - val_loss: 0.5910 - val_acc: 0.8695\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 313us/step - loss: 0.0024 - acc: 1.0000 - val_loss: 0.6040 - val_acc: 0.8695\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 310us/step - loss: 0.0019 - acc: 1.0000 - val_loss: 0.6628 - val_acc: 0.8618\n",
      "2-conv-32-nodes-2-dense-1544500200\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 1s 423us/step - loss: 0.8301 - acc: 0.6163 - val_loss: 0.6369 - val_acc: 0.7244\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 337us/step - loss: 0.5103 - acc: 0.7998 - val_loss: 0.4789 - val_acc: 0.8179\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 356us/step - loss: 0.4109 - acc: 0.8468 - val_loss: 0.4622 - val_acc: 0.8207\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 349us/step - loss: 0.3427 - acc: 0.8770 - val_loss: 0.3798 - val_acc: 0.8660\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 342us/step - loss: 0.2873 - acc: 0.8979 - val_loss: 0.3446 - val_acc: 0.8709\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 348us/step - loss: 0.2630 - acc: 0.9057 - val_loss: 0.3554 - val_acc: 0.8618\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 352us/step - loss: 0.2245 - acc: 0.9237 - val_loss: 0.3720 - val_acc: 0.8555\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 352us/step - loss: 0.2009 - acc: 0.9255 - val_loss: 0.3573 - val_acc: 0.8681\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 348us/step - loss: 0.1937 - acc: 0.9276 - val_loss: 0.4277 - val_acc: 0.8604\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 352us/step - loss: 0.1593 - acc: 0.9395 - val_loss: 0.3753 - val_acc: 0.8723\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 339us/step - loss: 0.1150 - acc: 0.9590 - val_loss: 0.5178 - val_acc: 0.8472\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 346us/step - loss: 0.1125 - acc: 0.9587 - val_loss: 0.6337 - val_acc: 0.8165\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 350us/step - loss: 0.0987 - acc: 0.9677 - val_loss: 0.5892 - val_acc: 0.8318\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 356us/step - loss: 0.0782 - acc: 0.9719 - val_loss: 0.4453 - val_acc: 0.8793\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 351us/step - loss: 0.0506 - acc: 0.9835 - val_loss: 0.4652 - val_acc: 0.8737\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 354us/step - loss: 0.0352 - acc: 0.9910 - val_loss: 0.5521 - val_acc: 0.8521\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 335us/step - loss: 0.0361 - acc: 0.9904 - val_loss: 0.5488 - val_acc: 0.8653\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 336us/step - loss: 0.0155 - acc: 0.9979 - val_loss: 0.6105 - val_acc: 0.8660\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 350us/step - loss: 0.0156 - acc: 0.9973 - val_loss: 0.6093 - val_acc: 0.8695\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 345us/step - loss: 0.0237 - acc: 0.9925 - val_loss: 0.5642 - val_acc: 0.8751\n",
      "3-conv-32-nodes-2-dense-1544500227\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 2s 478us/step - loss: 0.8885 - acc: 0.5579 - val_loss: 0.8449 - val_acc: 0.6336\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 361us/step - loss: 0.6657 - acc: 0.7189 - val_loss: 0.5955 - val_acc: 0.7551\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 391us/step - loss: 0.5107 - acc: 0.8114 - val_loss: 0.5459 - val_acc: 0.7662\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 380us/step - loss: 0.4642 - acc: 0.8252 - val_loss: 0.5129 - val_acc: 0.7941\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 382us/step - loss: 0.4083 - acc: 0.8402 - val_loss: 0.4685 - val_acc: 0.8151\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 392us/step - loss: 0.3851 - acc: 0.8572 - val_loss: 0.4629 - val_acc: 0.8186\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 384us/step - loss: 0.3425 - acc: 0.8692 - val_loss: 0.4188 - val_acc: 0.8374\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 379us/step - loss: 0.3083 - acc: 0.8857 - val_loss: 0.4329 - val_acc: 0.8346\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 370us/step - loss: 0.2812 - acc: 0.8961 - val_loss: 0.3724 - val_acc: 0.8542\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 372us/step - loss: 0.2526 - acc: 0.9081 - val_loss: 0.3781 - val_acc: 0.8639\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 374us/step - loss: 0.2539 - acc: 0.9051 - val_loss: 0.3968 - val_acc: 0.8528\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 379us/step - loss: 0.1947 - acc: 0.9291 - val_loss: 0.3864 - val_acc: 0.8625\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 386us/step - loss: 0.1857 - acc: 0.9264 - val_loss: 0.3837 - val_acc: 0.8660\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 380us/step - loss: 0.1624 - acc: 0.9389 - val_loss: 0.3848 - val_acc: 0.8737\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 375us/step - loss: 0.1794 - acc: 0.9342 - val_loss: 0.3883 - val_acc: 0.8653\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 372us/step - loss: 0.1261 - acc: 0.9557 - val_loss: 0.4182 - val_acc: 0.8583\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 371us/step - loss: 0.1052 - acc: 0.9635 - val_loss: 0.4276 - val_acc: 0.8737\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 370us/step - loss: 0.0955 - acc: 0.9662 - val_loss: 0.4579 - val_acc: 0.8709\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 387us/step - loss: 0.0712 - acc: 0.9755 - val_loss: 0.4481 - val_acc: 0.8758\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 379us/step - loss: 0.0554 - acc: 0.9808 - val_loss: 0.5560 - val_acc: 0.8632\n",
      "1-conv-64-nodes-2-dense-1544500256\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 1s 429us/step - loss: 0.7436 - acc: 0.6749 - val_loss: 0.5462 - val_acc: 0.7746\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 317us/step - loss: 0.4029 - acc: 0.8465 - val_loss: 0.5679 - val_acc: 0.7697\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 338us/step - loss: 0.2630 - acc: 0.9042 - val_loss: 0.3978 - val_acc: 0.8465\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 339us/step - loss: 0.1561 - acc: 0.9482 - val_loss: 0.3627 - val_acc: 0.8674\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 328us/step - loss: 0.0837 - acc: 0.9787 - val_loss: 0.3984 - val_acc: 0.8653\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 328us/step - loss: 0.0543 - acc: 0.9856 - val_loss: 0.5576 - val_acc: 0.8234\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 330us/step - loss: 0.0296 - acc: 0.9952 - val_loss: 0.4748 - val_acc: 0.8646\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 320us/step - loss: 0.0164 - acc: 0.9976 - val_loss: 0.5347 - val_acc: 0.8639\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 320us/step - loss: 0.0075 - acc: 0.9997 - val_loss: 0.5412 - val_acc: 0.8758\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 320us/step - loss: 0.0032 - acc: 1.0000 - val_loss: 0.5700 - val_acc: 0.8667\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 316us/step - loss: 0.0019 - acc: 1.0000 - val_loss: 0.5976 - val_acc: 0.8597\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 319us/step - loss: 0.0013 - acc: 1.0000 - val_loss: 0.6122 - val_acc: 0.8667\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 326us/step - loss: 0.0010 - acc: 1.0000 - val_loss: 0.6244 - val_acc: 0.8639\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 321us/step - loss: 7.9842e-04 - acc: 1.0000 - val_loss: 0.6385 - val_acc: 0.8702\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 325us/step - loss: 6.6173e-04 - acc: 1.0000 - val_loss: 0.6440 - val_acc: 0.8674\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 344us/step - loss: 5.8005e-04 - acc: 1.0000 - val_loss: 0.6601 - val_acc: 0.8632\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 339us/step - loss: 4.7405e-04 - acc: 1.0000 - val_loss: 0.6653 - val_acc: 0.8688\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 339us/step - loss: 4.0916e-04 - acc: 1.0000 - val_loss: 0.6762 - val_acc: 0.8681\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 333us/step - loss: 3.4884e-04 - acc: 1.0000 - val_loss: 0.6969 - val_acc: 0.8618\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 335us/step - loss: 3.0858e-04 - acc: 1.0000 - val_loss: 0.6932 - val_acc: 0.8660\n",
      "2-conv-64-nodes-2-dense-1544500281\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 2s 469us/step - loss: 0.7486 - acc: 0.6552 - val_loss: 0.5505 - val_acc: 0.7739\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 373us/step - loss: 0.4441 - acc: 0.8336 - val_loss: 0.4101 - val_acc: 0.8535\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 374us/step - loss: 0.3476 - acc: 0.8665 - val_loss: 0.3638 - val_acc: 0.8576\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 376us/step - loss: 0.2701 - acc: 0.8973 - val_loss: 0.3870 - val_acc: 0.8528\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 383us/step - loss: 0.2167 - acc: 0.9150 - val_loss: 0.4307 - val_acc: 0.8444\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 381us/step - loss: 0.1786 - acc: 0.9327 - val_loss: 0.3584 - val_acc: 0.8730\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 379us/step - loss: 0.1477 - acc: 0.9419 - val_loss: 0.4031 - val_acc: 0.8758\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 381us/step - loss: 0.0970 - acc: 0.9617 - val_loss: 0.3717 - val_acc: 0.8890\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 374us/step - loss: 0.0840 - acc: 0.9671 - val_loss: 0.5307 - val_acc: 0.8611\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 359us/step - loss: 0.0618 - acc: 0.9773 - val_loss: 0.4616 - val_acc: 0.8814\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 356us/step - loss: 0.0255 - acc: 0.9925 - val_loss: 0.5077 - val_acc: 0.8897\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 360us/step - loss: 0.0176 - acc: 0.9961 - val_loss: 0.4943 - val_acc: 0.8814\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 360us/step - loss: 0.0358 - acc: 0.9859 - val_loss: 0.5098 - val_acc: 0.8904\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 374us/step - loss: 0.0150 - acc: 0.9967 - val_loss: 0.5545 - val_acc: 0.8786\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 373us/step - loss: 0.0124 - acc: 0.9970 - val_loss: 0.5996 - val_acc: 0.8904\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 371us/step - loss: 0.0038 - acc: 0.9997 - val_loss: 0.5947 - val_acc: 0.8911\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 380us/step - loss: 8.2714e-04 - acc: 1.0000 - val_loss: 0.6515 - val_acc: 0.8876\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 375us/step - loss: 5.6968e-04 - acc: 1.0000 - val_loss: 0.6534 - val_acc: 0.8925\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 364us/step - loss: 4.2245e-04 - acc: 1.0000 - val_loss: 0.6811 - val_acc: 0.8918\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 372us/step - loss: 3.3809e-04 - acc: 1.0000 - val_loss: 0.6930 - val_acc: 0.8911\n",
      "3-conv-64-nodes-2-dense-1544500309\n",
      "Train on 3341 samples, validate on 1433 samples\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 2s 517us/step - loss: 0.8946 - acc: 0.5555 - val_loss: 0.7351 - val_acc: 0.6790\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 383us/step - loss: 0.6135 - acc: 0.7465 - val_loss: 0.5839 - val_acc: 0.7579\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 405us/step - loss: 0.4674 - acc: 0.8180 - val_loss: 0.4811 - val_acc: 0.7983\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 397us/step - loss: 0.4181 - acc: 0.8444 - val_loss: 0.4911 - val_acc: 0.8109\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 393us/step - loss: 0.3530 - acc: 0.8728 - val_loss: 0.3701 - val_acc: 0.8667\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 391us/step - loss: 0.2905 - acc: 0.8967 - val_loss: 0.3453 - val_acc: 0.8695\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 414us/step - loss: 0.2578 - acc: 0.9018 - val_loss: 0.3645 - val_acc: 0.8632\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 399us/step - loss: 0.2392 - acc: 0.9099 - val_loss: 0.3537 - val_acc: 0.8709\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 407us/step - loss: 0.1805 - acc: 0.9336 - val_loss: 0.3347 - val_acc: 0.8835\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 397us/step - loss: 0.1573 - acc: 0.9407 - val_loss: 0.3253 - val_acc: 0.8918\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 379us/step - loss: 0.1354 - acc: 0.9491 - val_loss: 0.3470 - val_acc: 0.8939\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 399us/step - loss: 0.1060 - acc: 0.9623 - val_loss: 0.3815 - val_acc: 0.8695\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 404us/step - loss: 0.0852 - acc: 0.9689 - val_loss: 0.4266 - val_acc: 0.8821\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 409us/step - loss: 0.0526 - acc: 0.9835 - val_loss: 0.3978 - val_acc: 0.8981\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 400us/step - loss: 0.0422 - acc: 0.9844 - val_loss: 0.4360 - val_acc: 0.8890\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 408us/step - loss: 0.0271 - acc: 0.9919 - val_loss: 0.5257 - val_acc: 0.8758\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 408us/step - loss: 0.0290 - acc: 0.9910 - val_loss: 0.4670 - val_acc: 0.8890\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 407us/step - loss: 0.0490 - acc: 0.9850 - val_loss: 0.4594 - val_acc: 0.8842\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 404us/step - loss: 0.0218 - acc: 0.9940 - val_loss: 0.5103 - val_acc: 0.8939\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 409us/step - loss: 0.0222 - acc: 0.9922 - val_loss: 0.6980 - val_acc: 0.8632\n",
      "1-conv-128-nodes-2-dense-1544500340\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 2s 585us/step - loss: 0.6221 - acc: 0.7453 - val_loss: 0.4501 - val_acc: 0.8269\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 2s 455us/step - loss: 0.3199 - acc: 0.8791 - val_loss: 0.3777 - val_acc: 0.8597\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 2s 488us/step - loss: 0.1694 - acc: 0.9401 - val_loss: 0.3697 - val_acc: 0.8744\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 2s 491us/step - loss: 0.0799 - acc: 0.9737 - val_loss: 0.4321 - val_acc: 0.8660\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 2s 491us/step - loss: 0.0362 - acc: 0.9910 - val_loss: 0.4780 - val_acc: 0.8674\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 2s 489us/step - loss: 0.0154 - acc: 0.9979 - val_loss: 0.6381 - val_acc: 0.8555\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 2s 491us/step - loss: 0.0044 - acc: 0.9997 - val_loss: 0.5928 - val_acc: 0.8695\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 2s 487us/step - loss: 0.0012 - acc: 1.0000 - val_loss: 0.6180 - val_acc: 0.8688\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 2s 491us/step - loss: 6.7248e-04 - acc: 1.0000 - val_loss: 0.6327 - val_acc: 0.8716\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 2s 488us/step - loss: 5.2028e-04 - acc: 1.0000 - val_loss: 0.6566 - val_acc: 0.8723\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 2s 488us/step - loss: 3.9820e-04 - acc: 1.0000 - val_loss: 0.6684 - val_acc: 0.8695\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 2s 491us/step - loss: 3.0441e-04 - acc: 1.0000 - val_loss: 0.6860 - val_acc: 0.8737\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 2s 490us/step - loss: 2.5178e-04 - acc: 1.0000 - val_loss: 0.6905 - val_acc: 0.8730\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 2s 484us/step - loss: 2.1389e-04 - acc: 1.0000 - val_loss: 0.7032 - val_acc: 0.8737\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 2s 493us/step - loss: 1.7997e-04 - acc: 1.0000 - val_loss: 0.7066 - val_acc: 0.8744\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 2s 486us/step - loss: 1.5471e-04 - acc: 1.0000 - val_loss: 0.7174 - val_acc: 0.8723\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 2s 468us/step - loss: 1.3380e-04 - acc: 1.0000 - val_loss: 0.7238 - val_acc: 0.8730\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 2s 468us/step - loss: 1.1593e-04 - acc: 1.0000 - val_loss: 0.7328 - val_acc: 0.8716\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 2s 463us/step - loss: 9.9084e-05 - acc: 1.0000 - val_loss: 0.7411 - val_acc: 0.8737\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 2s 468us/step - loss: 8.7744e-05 - acc: 1.0000 - val_loss: 0.7490 - val_acc: 0.8737\n",
      "2-conv-128-nodes-2-dense-1544500376\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 2s 533us/step - loss: 0.6813 - acc: 0.7046 - val_loss: 0.5341 - val_acc: 0.7774\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 400us/step - loss: 0.3974 - acc: 0.8488 - val_loss: 0.3722 - val_acc: 0.8590\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 1s 417us/step - loss: 0.2882 - acc: 0.8949 - val_loss: 0.3898 - val_acc: 0.8486\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 1s 418us/step - loss: 0.2153 - acc: 0.9225 - val_loss: 0.3593 - val_acc: 0.8597\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 1s 417us/step - loss: 0.1513 - acc: 0.9443 - val_loss: 0.3897 - val_acc: 0.8730\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 1s 422us/step - loss: 0.1078 - acc: 0.9596 - val_loss: 0.4359 - val_acc: 0.8723\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 1s 422us/step - loss: 0.0727 - acc: 0.9746 - val_loss: 0.5773 - val_acc: 0.8562\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 1s 412us/step - loss: 0.0350 - acc: 0.9874 - val_loss: 0.5375 - val_acc: 0.8716\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 1s 408us/step - loss: 0.0394 - acc: 0.9874 - val_loss: 0.6106 - val_acc: 0.8618\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 1s 416us/step - loss: 0.0260 - acc: 0.9925 - val_loss: 0.5989 - val_acc: 0.8897\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 1s 415us/step - loss: 0.0056 - acc: 0.9991 - val_loss: 0.7751 - val_acc: 0.8646\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 1s 415us/step - loss: 0.0134 - acc: 0.9970 - val_loss: 0.5907 - val_acc: 0.8863\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 1s 417us/step - loss: 0.0016 - acc: 1.0000 - val_loss: 0.6334 - val_acc: 0.8890\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 1s 417us/step - loss: 5.2945e-04 - acc: 1.0000 - val_loss: 0.6554 - val_acc: 0.8883\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 1s 417us/step - loss: 2.3181e-04 - acc: 1.0000 - val_loss: 0.6811 - val_acc: 0.8904\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 1s 414us/step - loss: 1.5251e-04 - acc: 1.0000 - val_loss: 0.6857 - val_acc: 0.8897\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 1s 414us/step - loss: 1.1429e-04 - acc: 1.0000 - val_loss: 0.7031 - val_acc: 0.8911\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 1s 406us/step - loss: 9.4212e-05 - acc: 1.0000 - val_loss: 0.7126 - val_acc: 0.8897\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 1s 403us/step - loss: 7.5981e-05 - acc: 1.0000 - val_loss: 0.7193 - val_acc: 0.8904\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 1s 414us/step - loss: 6.3391e-05 - acc: 1.0000 - val_loss: 0.7281 - val_acc: 0.8918\n",
      "3-conv-128-nodes-2-dense-1544500408\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 2s 566us/step - loss: 0.8235 - acc: 0.6094 - val_loss: 0.6631 - val_acc: 0.7362\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 1s 432us/step - loss: 0.5124 - acc: 0.8096 - val_loss: 0.4844 - val_acc: 0.8067\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 2s 463us/step - loss: 0.4110 - acc: 0.8450 - val_loss: 0.3890 - val_acc: 0.8514\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 2s 474us/step - loss: 0.3419 - acc: 0.8737 - val_loss: 0.4259 - val_acc: 0.8311\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 2s 472us/step - loss: 0.2731 - acc: 0.9003 - val_loss: 0.3420 - val_acc: 0.8772\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 2s 471us/step - loss: 0.2257 - acc: 0.9180 - val_loss: 0.3569 - val_acc: 0.8786\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 2s 483us/step - loss: 0.1861 - acc: 0.9297 - val_loss: 0.3336 - val_acc: 0.8772\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 2s 469us/step - loss: 0.1576 - acc: 0.9416 - val_loss: 0.3458 - val_acc: 0.8709\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 2s 469us/step - loss: 0.1064 - acc: 0.9623 - val_loss: 0.4018 - val_acc: 0.8758\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 2s 489us/step - loss: 0.0903 - acc: 0.9668 - val_loss: 0.4030 - val_acc: 0.8765\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 2s 451us/step - loss: 0.0921 - acc: 0.9644 - val_loss: 0.6523 - val_acc: 0.8486\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 2s 451us/step - loss: 0.0403 - acc: 0.9871 - val_loss: 0.5027 - val_acc: 0.8835\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 2s 478us/step - loss: 0.0307 - acc: 0.9892 - val_loss: 0.5694 - val_acc: 0.8521\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 2s 480us/step - loss: 0.0505 - acc: 0.9805 - val_loss: 0.5356 - val_acc: 0.8779\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 2s 475us/step - loss: 0.0176 - acc: 0.9955 - val_loss: 0.5974 - val_acc: 0.8876\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 2s 484us/step - loss: 0.0132 - acc: 0.9949 - val_loss: 0.6306 - val_acc: 0.8765\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 2s 487us/step - loss: 0.0657 - acc: 0.9758 - val_loss: 0.6057 - val_acc: 0.8849\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 2s 487us/step - loss: 0.0350 - acc: 0.9871 - val_loss: 0.7699 - val_acc: 0.8597\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 2s 479us/step - loss: 0.0611 - acc: 0.9790 - val_loss: 0.5624 - val_acc: 0.8974\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 2s 478us/step - loss: 0.0132 - acc: 0.9964 - val_loss: 0.6664 - val_acc: 0.8897\n",
      "1-conv-256-nodes-2-dense-1544500444\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 4s 1ms/step - loss: 0.7044 - acc: 0.7166 - val_loss: 0.4068 - val_acc: 0.8535\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 3s 964us/step - loss: 0.2982 - acc: 0.8937 - val_loss: 0.3658 - val_acc: 0.8618\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 3s 969us/step - loss: 0.1884 - acc: 0.9306 - val_loss: 0.3967 - val_acc: 0.8688\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 3s 969us/step - loss: 0.0795 - acc: 0.9758 - val_loss: 0.4440 - val_acc: 0.8632\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 3s 969us/step - loss: 0.0251 - acc: 0.9937 - val_loss: 0.6001 - val_acc: 0.8576\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 3s 968us/step - loss: 0.0175 - acc: 0.9943 - val_loss: 0.6088 - val_acc: 0.8548\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 3s 964us/step - loss: 0.0585 - acc: 0.9784 - val_loss: 0.5288 - val_acc: 0.8660\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 3s 966us/step - loss: 0.0400 - acc: 0.9859 - val_loss: 0.6750 - val_acc: 0.8486\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 3s 975us/step - loss: 0.0089 - acc: 0.9982 - val_loss: 0.7295 - val_acc: 0.8493\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 3s 982us/step - loss: 9.8340e-04 - acc: 1.0000 - val_loss: 0.7545 - val_acc: 0.8702\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 3s 969us/step - loss: 3.3294e-04 - acc: 1.0000 - val_loss: 0.7870 - val_acc: 0.8674\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 3s 975us/step - loss: 1.7872e-04 - acc: 1.0000 - val_loss: 0.8221 - val_acc: 0.8674\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 3s 973us/step - loss: 1.1334e-04 - acc: 1.0000 - val_loss: 0.8495 - val_acc: 0.8674\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 3s 968us/step - loss: 7.6699e-05 - acc: 1.0000 - val_loss: 0.8751 - val_acc: 0.8695\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 3s 971us/step - loss: 5.3692e-05 - acc: 1.0000 - val_loss: 0.8986 - val_acc: 0.8681\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 3s 962us/step - loss: 3.8764e-05 - acc: 1.0000 - val_loss: 0.9152 - val_acc: 0.8681\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 3s 968us/step - loss: 2.8002e-05 - acc: 1.0000 - val_loss: 0.9303 - val_acc: 0.8681\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 3s 978us/step - loss: 2.1510e-05 - acc: 1.0000 - val_loss: 0.9450 - val_acc: 0.8681\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 3s 977us/step - loss: 1.6906e-05 - acc: 1.0000 - val_loss: 0.9549 - val_acc: 0.8674\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 3s 968us/step - loss: 1.3548e-05 - acc: 1.0000 - val_loss: 0.9650 - val_acc: 0.8674\n",
      "2-conv-256-nodes-2-dense-1544500514\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 3s 824us/step - loss: 0.7057 - acc: 0.6887 - val_loss: 0.5245 - val_acc: 0.7997\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 2s 682us/step - loss: 0.3963 - acc: 0.8515 - val_loss: 0.4070 - val_acc: 0.8479\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 2s 688us/step - loss: 0.2820 - acc: 0.8985 - val_loss: 0.3543 - val_acc: 0.8737\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 2s 678us/step - loss: 0.2082 - acc: 0.9231 - val_loss: 0.3950 - val_acc: 0.8590\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 2s 685us/step - loss: 0.1540 - acc: 0.9404 - val_loss: 0.3613 - val_acc: 0.8807\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 2s 681us/step - loss: 0.1057 - acc: 0.9602 - val_loss: 0.4515 - val_acc: 0.8660\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 2s 676us/step - loss: 0.0801 - acc: 0.9737 - val_loss: 0.4543 - val_acc: 0.8716\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 2s 683us/step - loss: 0.0336 - acc: 0.9883 - val_loss: 0.5793 - val_acc: 0.8646\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 2s 678us/step - loss: 0.0360 - acc: 0.9877 - val_loss: 0.7079 - val_acc: 0.8590\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 2s 680us/step - loss: 0.0498 - acc: 0.9805 - val_loss: 0.9317 - val_acc: 0.8339\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 2s 682us/step - loss: 0.0192 - acc: 0.9943 - val_loss: 0.6021 - val_acc: 0.8890\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 2s 680us/step - loss: 0.0219 - acc: 0.9940 - val_loss: 0.6431 - val_acc: 0.8807\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 2s 667us/step - loss: 0.0033 - acc: 0.9991 - val_loss: 0.6493 - val_acc: 0.8856\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 2s 670us/step - loss: 8.7003e-04 - acc: 1.0000 - val_loss: 0.7037 - val_acc: 0.8863\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 2s 681us/step - loss: 1.4522e-04 - acc: 1.0000 - val_loss: 0.7089 - val_acc: 0.8863\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 2s 677us/step - loss: 9.2678e-05 - acc: 1.0000 - val_loss: 0.7215 - val_acc: 0.8863\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 2s 672us/step - loss: 7.0867e-05 - acc: 1.0000 - val_loss: 0.7326 - val_acc: 0.8870\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 2s 666us/step - loss: 5.6913e-05 - acc: 1.0000 - val_loss: 0.7411 - val_acc: 0.8870\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 2s 663us/step - loss: 4.7323e-05 - acc: 1.0000 - val_loss: 0.7502 - val_acc: 0.8870\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 2s 667us/step - loss: 3.9395e-05 - acc: 1.0000 - val_loss: 0.7585 - val_acc: 0.8876\n",
      "3-conv-256-nodes-2-dense-1544500564\n",
      "Train on 3341 samples, validate on 1433 samples\n",
      "Epoch 1/20\n",
      "3341/3341 [==============================] - 3s 791us/step - loss: 0.7724 - acc: 0.6498 - val_loss: 0.6668 - val_acc: 0.7013\n",
      "Epoch 2/20\n",
      "3341/3341 [==============================] - 2s 638us/step - loss: 0.5018 - acc: 0.8040 - val_loss: 0.4402 - val_acc: 0.8297\n",
      "Epoch 3/20\n",
      "3341/3341 [==============================] - 2s 671us/step - loss: 0.3873 - acc: 0.8557 - val_loss: 0.4708 - val_acc: 0.8074\n",
      "Epoch 4/20\n",
      "3341/3341 [==============================] - 2s 650us/step - loss: 0.3229 - acc: 0.8779 - val_loss: 0.3667 - val_acc: 0.8555\n",
      "Epoch 5/20\n",
      "3341/3341 [==============================] - 2s 647us/step - loss: 0.2615 - acc: 0.8982 - val_loss: 0.6293 - val_acc: 0.7704\n",
      "Epoch 6/20\n",
      "3341/3341 [==============================] - 2s 645us/step - loss: 0.2564 - acc: 0.9069 - val_loss: 0.3285 - val_acc: 0.8786\n",
      "Epoch 7/20\n",
      "3341/3341 [==============================] - 2s 638us/step - loss: 0.1600 - acc: 0.9380 - val_loss: 0.3416 - val_acc: 0.8890\n",
      "Epoch 8/20\n",
      "3341/3341 [==============================] - 2s 643us/step - loss: 0.1317 - acc: 0.9488 - val_loss: 0.4269 - val_acc: 0.8611\n",
      "Epoch 9/20\n",
      "3341/3341 [==============================] - 2s 637us/step - loss: 0.1352 - acc: 0.9473 - val_loss: 0.4853 - val_acc: 0.8562\n",
      "Epoch 10/20\n",
      "3341/3341 [==============================] - 2s 661us/step - loss: 0.0793 - acc: 0.9704 - val_loss: 0.4609 - val_acc: 0.8758\n",
      "Epoch 11/20\n",
      "3341/3341 [==============================] - 2s 664us/step - loss: 0.0884 - acc: 0.9695 - val_loss: 0.4726 - val_acc: 0.8716\n",
      "Epoch 12/20\n",
      "3341/3341 [==============================] - 2s 657us/step - loss: 0.0487 - acc: 0.9838 - val_loss: 0.5589 - val_acc: 0.8744\n",
      "Epoch 13/20\n",
      "3341/3341 [==============================] - 2s 656us/step - loss: 0.0209 - acc: 0.9937 - val_loss: 0.6493 - val_acc: 0.8821\n",
      "Epoch 14/20\n",
      "3341/3341 [==============================] - 2s 674us/step - loss: 0.0120 - acc: 0.9955 - val_loss: 0.6941 - val_acc: 0.8688\n",
      "Epoch 15/20\n",
      "3341/3341 [==============================] - 2s 671us/step - loss: 0.0019 - acc: 0.9997 - val_loss: 0.7276 - val_acc: 0.8897\n",
      "Epoch 16/20\n",
      "3341/3341 [==============================] - 2s 658us/step - loss: 0.0674 - acc: 0.9752 - val_loss: 0.6091 - val_acc: 0.8569\n",
      "Epoch 17/20\n",
      "3341/3341 [==============================] - 2s 641us/step - loss: 0.0654 - acc: 0.9793 - val_loss: 0.5445 - val_acc: 0.8876\n",
      "Epoch 18/20\n",
      "3341/3341 [==============================] - 2s 637us/step - loss: 0.0547 - acc: 0.9811 - val_loss: 0.5707 - val_acc: 0.8737\n",
      "Epoch 19/20\n",
      "3341/3341 [==============================] - 2s 650us/step - loss: 0.0095 - acc: 0.9973 - val_loss: 0.5985 - val_acc: 0.8904\n",
      "Epoch 20/20\n",
      "3341/3341 [==============================] - 2s 665us/step - loss: 0.0016 - acc: 1.0000 - val_loss: 0.7221 - val_acc: 0.8814\n"
     ]
    }
   ],
   "source": [
    "'''Build and train CNN model'''\n",
    "\n",
    "num_classes = 3\n",
    "input_shape = X_train.shape[1:]\n",
    "\n",
    "dense_layers = [0, 1, 2]\n",
    "layer_sizes = [32, 64, 128, 256]\n",
    "conv_layers = [1, 2, 3]\n",
    "\n",
    "for dense_layer in dense_layers:\n",
    "    for layer_size in layer_sizes:\n",
    "        for conv_layer in conv_layers:\n",
    "            NAME = \"{}-conv-{}-nodes-{}-dense-{}\".format(conv_layer, layer_size, dense_layer, int(time.time()))\n",
    "            print(NAME)\n",
    "\n",
    "            model = Sequential()\n",
    "\n",
    "            model.add(Conv2D(layer_size, (3, 3), input_shape=input_shape))\n",
    "            model.add(Activation('relu'))\n",
    "            model.add(MaxPooling2D(pool_size=(2, 2)))\n",
    "\n",
    "            for l in range(conv_layer-1):\n",
    "                model.add(Conv2D(layer_size, (3, 3)))\n",
    "                model.add(Activation('relu'))\n",
    "                model.add(MaxPooling2D(pool_size=(2, 2)))\n",
    "\n",
    "            model.add(Flatten())\n",
    "\n",
    "            for _ in range(dense_layer):\n",
    "                model.add(Dense(layer_size))\n",
    "                model.add(Activation('relu'))\n",
    "\n",
    "            model.add(Dense(num_classes))\n",
    "            model.add(Activation('softmax'))\n",
    "\n",
    "            tensorboard = TensorBoard(log_dir=\"logs/{}\".format(NAME))\n",
    "\n",
    "            model.compile(loss='categorical_crossentropy',\n",
    "                          optimizer='adam',\n",
    "                          metrics=['accuracy'])\n",
    "\n",
    "            model.fit(X_train, y_train,\n",
    "                      batch_size=32,\n",
    "                      epochs=20,\n",
    "                      validation_split=0.3,\n",
    "                      callbacks=[tensorboard])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
